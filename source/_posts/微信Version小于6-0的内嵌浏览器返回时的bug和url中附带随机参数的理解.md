---
title: 微信Version小于6.0的内嵌浏览器返回时的bug和url中附带随机参数的理解
id: 161
categories:
  - Bug轰炸机
  - 微信Bug
date: 2015-12-09 20:41:43
tags:
---

<Excerpt in index | 首页摘要>
+ 微信webview6.0以下版本出现的bug
+ 解决方案

<!-- more -->
<The rest of contents | 余下全文>

微信6.0版本以下内嵌的浏览器在进入二级页面的时候，点击微信自带的返回按纽，返回一级页面，在更多按纽中的从浏览器打开的时候，其实是打开的二级页面的链接，这个bug很奇葩，可能是因为一级页面有缓存之后，返回的时候开发者忘了更新“更多”中附带的url的值了。

> 所以就需要我们去手动更改这个url。

原理我已经说了，就是一级页面的url没有变化，导致了这个bug的产生。

我们怎样是这个url参数变化呢？

嗯，容我想想。

这个要结合你的实际情况在代码里面控制逻辑修改的。



> 我的应用场景是这样的

	在一级页面里面有个按纽，我需要点击它显示一个在一级页面中已经加载好的标签，然后在点击右上角的更多，从浏览器打开，但是在一级页面中有二级页面的链接，用户可能会点击二级页面后再返回回来，这时更多里面的url就变成了二级页面的url，所以 我们需要控制下逻辑。在高版本的微信中没有这个bug。



> 首先，当我们点击按钮的时候，判断他是否是低版本的微信，这个需要你使用正则去判断。
&nbsp;
> 如果是低版本的微信的话，

        首先保存现在的地址，var url = location.href;

       然后 localtion.href  = url + "?fresh="+Date.now();

> 这样你再从低版本的“更多”中打开”从浏览器打开“就不会出现缓存二级页面url的bug；





	这个办法巧妙的避开了这个bug，然而对于这种需求是很少的，你可能不会遇到，不过注意下。



	url中附带一个随机的参数时防止浏览器中url缓存，可以及时的更行url对应的state，由不耽误访问该链接，只要你的参数不和原来的参数冲突就行。